<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title><%= title %></title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap –∏–∑ CDN –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .card { margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .header { background: #2c3e50; color: white; padding: 20px 0; margin-bottom: 30px; }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>üöÄ Space Mission Control</h1>
            <p>Monolithic Distributed System Dashboard</p>
        </div>
    </div>

    <div class="container">
        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="row mb-4">
            <div class="col-md-8">
                <input type="text" id="searchInput" class="form-control" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É...">
            </div>
            <div class="col-md-4">
                <button class="btn btn-primary w-100" onclick="loadData()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </div>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö -->
        <div class="card">
            <div class="card-header bg-white">
                <h5 class="mb-0">–í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏</h5>
            </div>
            <div class="card-body">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ò—Å—Ç–æ—á–Ω–∏–∫</th>
                            <th>–î–∞–Ω–Ω—ã–µ (JSON)</th>
                            <th>–í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr><td colspan="4" class="text-center">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        async function loadData() {
            try {
                const response = await fetch('/api/proxy/data');
                const data = await response.json();
                const tbody = document.getElementById('tableBody');
                tbody.innerHTML = '';

                data.forEach(item => {
                    const row = `<tr>
                        <td>${item.id}</td>
                        <td><span class="badge bg-info text-dark">${item.source}</span></td>
                        <td><small>${JSON.stringify(item.data).substring(0, 50)}...</small></td>
                        <td>${new Date(item.fetched_at).toLocaleString()}</td>
                    </tr>`;
                    tbody.innerHTML += row;
                });
            } catch (e) {
                console.error(e);
                document.getElementById('tableBody').innerHTML = '<tr><td colspan="4" class="text-danger">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</td></tr>';
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        loadData();
    </script>
</body>
</html>
